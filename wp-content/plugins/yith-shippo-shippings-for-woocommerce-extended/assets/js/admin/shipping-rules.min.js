jQuery((function(i){i("#yith_shippo_rule_fee_fee_type").on("change",(function(e){var t=i(this).val(),n=i("#yith_shippo_rule_fee").find(".fixed"),s=i("#yith_shippo_rule_fee").find(".percentage");"fixed"===t?(n.show(),s.hide()):(n.hide(),s.show())})).trigger("change"),i("#yith_shippo_rule_service").on("change",(function(e){var t=i(this).val(),n=i("#yith_shippo_rule_label_enabled");"all"===t?(n.is(":checked")&&n.click(),n.parents("tr").hide()):n.parents("tr").show()})).trigger("change"),i("#yith_shippo_shipping_rule_table").length&&i(document).on("click",(function(){window.onbeforeunload=null})),i(".yith_toggle_rule input").on("change",(function(e){var t=i(this).closest("tr"),n=t.closest("table"),s=i(this).is(":checked"),o=t.find("th.check-column input").val(),h={action:yith_shippo_shipping_rules_params.actions.toggleRuleStatus,rule_id:o,rule_status:s,security:yith_shippo_shipping_rules_params.security};n.block({message:"",overlayCSS:{backgroundColor:"#FFFFFF",opacity:.8,cursor:"wait"}}),i.ajax({type:"POST",url:yith_shippo_shipping_rules_params.ajaxurl,data:h,dataType:"json",success:function(i){n.unblock()}})}));var e={template:wp.template("yith-shppo-new-condition-row"),dom:{rulesListContainer:i("#yith-shippo-subconditions-wrapper"),ruleList:!1,addNew:i("#yith_shippo_new_condition")},index:0,_initParams:function(){this.dom.ruleList=this.dom.rulesListContainer.find(".yith-shippo-subcondition-list"),this.index=this.dom.ruleList.find(".yith-shippo-subcondition-row").length||0},init:function(){this._initParams(),this.dom.addNew.on("click",this.addNewRule),i(document).on("change","select.yith-shippo-subcondition-type",this.handleSubTypeChange),i(document).on("click",".yith-shippo-remove-rule",this.removeRule),i("select.yith-shippo-subcondition-type").each((function(){e.handleSubTypeChange.call(i(this))}))},nextIndex:function(){return++this.index},addNewRule:function(t){t.preventDefault();var n=e.nextIndex(),s=i(e.template({index:n}));e.dom.ruleList.append(s),i(document.body).trigger("wc-enhanced-select-init"),i(document).trigger("yith_fields_init"),e.handleSubTypeChange.call(s.find("select.yith-shippo-subcondition-type"))},handleSubTypeChange:function(e){var t=i(this).val(),n=i(this).parents(".yith-shippo-subcondition-row"),s=n.find(".yith_shippo_shipping_cost_mode").parents(".option-element"),o=n.find(".yith_shippo_shipping_cost_value").parents(".option-element"),h=n.find(".yith_shippo_shipping_cost_currency").parents(".option-element"),p=n.find(".yith-post-search").parents(".option-element"),a=n.find(".yith-term-search").parents(".option-element");"shipping_cost"===t?(s.show(),o.show(),h.show(),p.hide(),a.hide()):"product_ids"===t?(s.hide(),o.hide(),h.hide(),p.show(),a.hide()):(s.hide(),o.hide(),h.hide(),p.hide(),a.show())},removeRule:function(e){e.preventDefault(),i(this).parents(".yith-shippo-subcondition-row").remove().remove()}};e.init(),i("#yith_shippo_shipping_rule_detail #main-save-button").on("click",(function(e){e.preventDefault(),e.stopPropagation();var t=i(this).closest("form").find(".yith-plugin-fw--required"),n=!0,s=!1;t.each((function(){var e=i(this);if(e.is(":visible")){if(e.hasClass("rule-condition"))e.find(".yith-shippo-subcondition-list .yith-shippo-subcondition-row").each((function(){var e=i(this).find(".yith-term-search,.yith-post-search").filter(":visible");0===e.find(":selected").length&&(n=!1,e.parent().find(".select2.select2-container").addClass("required"))}));else if(e.hasClass("fee-charge"))e.find("input").isNumeric()||(n=!1,e.find("input").addClass("required"));else if(e.hasClass("shipping-zones")){var t=i(".yith-shipping-zone-list");0===t.find(".yith-plugin-fw-checkbox-array__row.selected").length&&(n=!1,t.find(".yith-plugin-fw-checkbox-array__row span").addClass("required"))}else""===e.find("input").val()&&(n=!1,e.find("input").addClass("required"));n||s||(s=e)}})),n?i(this).closest("form").submit():s.scroll_to()}))}));